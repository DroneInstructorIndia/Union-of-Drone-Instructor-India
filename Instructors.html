<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="List of Drone Instructors - Union of Drone Instructor India">
  <title>Instructors List - Union of Drone Instructor India</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script> <!-- Load SheetJS -->
  <style>
    /* Your CSS styles here (as you have defined above) */
    body {
      font-family: 'Arial', sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f4f4f4;
    }

    header {
      background-color: #007bff;
      color: white;
      padding: 20px;
      text-align: center;
    }

    section {
      padding: 20px;
      max-width: 1100px;
      margin: 20px auto;
      background-color: white;
      border-radius: 10px;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
    }

    .instructors-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }

    .instructors-table th, .instructors-table td {
      padding: 12px;
      text-align: left;
      border: 1px solid #ddd;
    }

    .instructors-table th {
      background-color: #007bff;
      color: white;
    }

    /* Other styles here... */
  </style>
</head>
<body>

  <!-- Header Section -->
  <header>
    <h1>Union of Drone Instructor India</h1>
  </header>

  <!-- Instructor List Section -->
  <section>
    <h2>Instructors of Our Group Members</h2>

    <!-- Search Bar -->
    <div class="search-container">
      <input type="text" id="instructorSearch" onkeyup="searchInstructors()" placeholder="Search Instructor by Name">
    </div>

    <!-- Instructor Table -->
    <table class="instructors-table" id="instructorsTable">
      <thead>
        <tr>
          <th>Serial No.</th>
          <th>Name of Instructor</th>
          <th>Class of Instructor</th>
          <th>Serial Number (DSP List)</th>
        </tr>
      </thead>
      <tbody>
        <!-- Data will be populated here -->
      </tbody>
    </table>

    <!-- Disclaimer Section -->
    <div class="disclaimer">
      <p>This is a list of instructors who have joined our WhatsApp Community Group. If you want to check the complete list of certified instructors, please visit the official Government of India Digital Sky platform.</p>
    </div>
  </section>

  <script>
    async function fetchExcelData(url) {
      const response = await fetch(url);
      const data = await response.arrayBuffer();
      const workbook = XLSX.read(data);
      const firstSheetName = workbook.SheetNames[0];
      const worksheet = workbook.Sheets[firstSheetName];
      return XLSX.utils.sheet_to_json(worksheet);
    }

    function populateTable(instructors) {
      const tableBody = document.getElementById('instructorsTable').getElementsByTagName('tbody')[0];
      tableBody.innerHTML = ""; // Clear existing rows

      instructors.forEach((instructor) => {
        const newRow = tableBody.insertRow();
        newRow.insertCell().textContent = instructor['Serial No.'] || ''; // Adjust based on your Excel column names
        newRow.insertCell().textContent = instructor['Name of Instructor'] || '';
        newRow.insertCell().textContent = instructor['Class of Instructor'] || '';
        newRow.insertCell().textContent = instructor['Serial Number (DSP List)'] || '';
      });
    }

    function searchInstructors() {
      const input = document.getElementById("instructorSearch").value.toUpperCase();
      const table = document.getElementById("instructorsTable");
      const tr = table.getElementsByTagName("tr");

      for (let i = 1; i < tr.length; i++) {
        let tdName = tr[i].getElementsByTagName("td")[1];
        if (tdName) {
          let txtValue = tdName.textContent || tdName.innerText;
          tr[i].style.display = txtValue.toUpperCase().indexOf(input) > -1 ? "" : "none";
        }
      }
    }

    // Fetch and populate data on page load
    window.onload = async () => {
      const url = 'https://github.com/androidbulb/Union-of-Drone-Instructor-India/blob/main/Resources/Sheets/InstructorsList.csv'; // Replace with your raw GitHub URL
      const instructors = await fetchExcelData(url);
      populateTable(instructors);
    };
  </script>

  <!-- Footer Section -->
  <footer>
    <p>&copy; 2024 Union of Drone Instructor India. All Rights Reserved.</p>
    <p>Free & Open Source Website</p>
  </footer>

</body>
</html>
